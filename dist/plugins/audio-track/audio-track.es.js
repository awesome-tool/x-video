import t from"video.js";function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},e.apply(this,arguments)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,i(t,e)}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}var a=function(t){function i(n,i){var a,r;(a=t.call(this,n,e({},i,{name:"AudioTrackSettingItem",label:"Audio",icon:"vjs-icon-audiotrack"}))||this).addClass("vjs-setting-audio");var o=function(t){"hls-audio-change"===t.name?(clearTimeout(r),r=setTimeout(a.handleAudioChangeEvent.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(a)),10)):"hls-alternate-audio"===t.name&&a.onAlternateAudio()};return n.ready((function(){n.tech_.on("usage",o)})),n.on("dispose",(function(){n.tech_.off("usage",o)})),n.on("audio-change",(function(t,e){var n=e.index;a.select(n),a.update(n)})),n.on("loadstart",(function(){a.hide()})),a}n(i,t);var a=i.prototype;return a.onChange=function(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];(e=t.prototype.onChange).call.apply(e,[this].concat(i)),this.player_.audio().pick(this.selected.value)},a.onAlternateAudio=function(){var t=this,e=this.player_.audio().values().map((function(e,n){var i=e.id,a=e.kind,r=e.label,o=e.language;return{label:t.localize(r),value:n,id:i,kind:a,language:o,index:n,track:e}}));this.player_.trigger("before-audio-setup",e),this.setEntries(e),this.show(),this.player_.trigger("audio",e)},a.handleAudioChangeEvent=function(){var t=this,e=this.player_.audio().values().reduce((function(e,n,i){return n.enabled&&(e=t.entries[i]),e}),{});this.player_.trigger("audio-change",e)},i}(t.getComponent("SettingOptionItem"));t.getComponent("SettingMenuButton").prototype.options_.entries.push("AudioTrackSettingItem"),t.registerComponent("AudioTrackSettingItem",a);var r=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,e,n)||this).track=i.values().find((function(t){return t.enabled})),e.on("audio-change",(function(t,e){var n=e.index;i.track=i.values()[n]})),i}n(e,t);var i=e.prototype;return i.values=function(){for(var t=this.player.audioTracks(),e=[],n=0;n<t.length;n++)e.push(t[n]);return e},i.pick=function(t){var e=this.values()[t];e&&(this.track.enabled=!1,this.track=e,e.enabled=!0)},e}(t.getPlugin("plugin"));t.registerPlugin("audio",r);
