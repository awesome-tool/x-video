!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}var a=function(e){function t(t,n){var r;return(r=e.call(this,t,i({name:"ExitPipButton"},n))||this).addClass("vjs-exit-pip-button"),r.el_.querySelector(".vjs-icon-placeholder").innerHTML="&#10005;",r}return r(t,e),t.prototype.handleClick=function(){this.options_.parentPlayer.pictureInPicture().exit()},t}(n.default.getComponent("ClickableComponent"));a.prototype.controlText_="Exit Pictutre In Pictutre",n.default.registerComponent("ExitPipButton",a);var p=function(e){function t(t,n){var i;return i=e.call(this,t,n)||this,t.addChild(new a(t,{parentPlayer:n.parentPlayer})),i.addChild(t),n.wrapper||(i.addClass("vjs-pip-player-wrapper"),document.body.appendChild(i.el_)),i}return r(t,e),t.prototype.createEl=function(){return this.options_.wrapper?this.options_.wrapper:e.prototype.createEl.call(this)},t}(n.default.getComponent("Component"));n.default.registerComponent("PipPlayerWrapper",p);var l=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).el_.querySelector(".vjs-icon-placeholder").className+=" vjs-icon-picture-in-picture",i}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-pip-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];(t=e.prototype.handleClick).call.apply(t,[this].concat(i)),this.player_.pictureInPicture().toggle()},t}(n.default.getComponent("Button"));l.prototype.controlText_="Picture in Picture",n.default.registerComponent("PipButton",l),n.default.hook("setup",(function(e){var t=e.findChild("SettingMenuButton")[0],n=t.parent,i=t.index;n.addChild(new l(e),{},i)}));var s=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,n)||this).cache_={},i.pipPlayer=null,i.options_=n,i.parentPlayer=t,i}r(t,e);var o=t.prototype;return o.toggle=function(){this.pipPlayer?this.exit():this.init()},o.init=function(){this.pipPlayer||(this.handleOriginPlayer(),this.createPipPlayer())},o.createPipPlayer=function(){var e=this.parentPlayer,t=this.options_,r=e.id_+"-pip-player",o=n.default.dom.createEl("video",{id:r,className:"vjs-pip-player"});document.body.appendChild(o);var a=i({},e.options_,e.cache_,{autoplay:!0,muted:e.muted()}),l=this.pipPlayer=n.default(o,a);this.wrapper=new p(l,i({},t,{parentPlayer:e})),this.dragzone=l.getChild("PlayToggleLayer"),this.updatePosition(i({},this.cache_,t)),l.ready((function(){l.currentTime(e.currentTime()),l.play()})),!1!==t.draggable&&this.draggable(this.dragzone.el_)},o.handleOriginPlayer=function(){var e=this,t=this.parentPlayer;t.pause(),t.hasStarted(!1),t.controls(!1),t.addClass("vjs-pip-player-enabled"),t.one("play",(function(){e.exit()}))},o.exit=function(){var e=this.parentPlayer,t=this.pipPlayer,n=this.wrapper;e&&(e.controls(!0),e.removeClass("vjs-pip-player-enabled"),e.paused()&&e.play(),t&&(t.ended()||e.currentTime(t.currentTime()))),t&&(t.dispose(),n.dispose()),this.pipPlayer=null},o.dispose=function(){this.parentPlayer=null},o.updatePosition=function(e){var t=e.x,n=e.y;void 0!==t&&void 0!==n&&(this.wrapper.el_.style.bottom=n+"px",this.wrapper.el_.style.left=t+"px")},o.draggable=function(e){var t,n,i=this,r=this,o=function(r){r.preventDefault(),i.cache_.x=Math.max(0,Math.min(window.innerWidth-e.offsetWidth,r.clientX-t)),i.cache_.y=Math.max(0,Math.min(window.innerHeight-e.offsetHeight,window.innerHeight-r.clientY-e.offsetHeight+n)),i.updatePosition(i.cache_)};e.addEventListener("mousedown",(function(e){e.preventDefault(),t=e.offsetX,n=e.offsetY;var i=function e(){window.removeEventListener("mousemove",e),r.dragzone.disable()};window.addEventListener("mousemove",o),window.addEventListener("mousemove",i),window.addEventListener("mouseup",(function e(t){window.removeEventListener("mouseup",e),window.removeEventListener("mousemove",o),window.removeEventListener("mousemove",i),setTimeout((function(){r.dragzone.enable()}),0)}))}));var a=function(){var t=i.cache_,n=t.x,r=t.y;i.updatePosition({x:Math.min(n,window.innerWidth-e.offsetWidth),y:Math.min(r,window.innerHeight-e.offsetHeight)})};window.addEventListener("resize",a),this.pipPlayer.on("dispose",(function(){window.removeEventListener("resize",a)}))},t}(n.default.getPlugin("plugin"));n.default.registerPlugin("pictureInPicture",s)}));
