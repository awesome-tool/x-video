!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).videojs)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function i(){return i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i.apply(this,arguments)}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}var a=function(t){function e(e,n){var o;return(o=t.call(this,e,i({},n,{name:"SubtitleSettingMenuItem",label:"Subtitles",icon:"vjs-icon-subtitles",entries:e.options_.subtitles||[]}))||this).addClass("vjs-setting-subtitles"),e.on("subtitles",(function(t,e){var n=!0,r=e.map((function(t,e){return n=!n||!t.default,i({},t,{value:e})}));o.setEntries([].concat(r,[{label:"Close Subtitles",value:-1,default:n}])),o.show()})),e.on("subtitlechange",(function(t,e){var n=e.index;-1===n&&(n=o.entries.length-1),o.select(n),o.update(n)})),o}return o(e,t),e.prototype.onChange=function(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=t.prototype.onChange).call.apply(e,[this].concat(i)),this.player_.subtitles().pick(this.selected.value)},e}(n.default.getComponent("SettingOptionItem"));n.default.getComponent("SettingMenuButton").prototype.options_.entries.push("SubtitleSettingMenuItem"),n.default.registerComponent("SubtitleSettingMenuItem",a);var s=function(t){function e(e,n){var i,o;(i=t.call(this,e,n)||this).flag=null,i.track=null;var r=function(){clearTimeout(o);var t=i.values(),n=t.find((function(t){return"showing"===t.mode}))||{},r=n.label||n.id||-1;o=setTimeout((function(){i.flag!==r&&(i.flag=r,e.trigger("subtitlechange",{index:t.indexOf(n),label:n.label||""}))}),10)};return e.textTracks().on("change",r),e.on("dispose",(function(){e.textTracks().off("change",r)})),i}o(e,t);var n=e.prototype;return n.values=function(){for(var t=this.player.textTracks(),e=[],n=0;n<t.length;n++)"subtitles"===t[n].kind&&e.push(t[n]);return e},n.load=function(t){void 0===t&&(t=[]);var e=this.player;if(t&&t.length){this.remove();var n=-1,o=[],r=t.map((function(t,r){var a=Object.assign({},t),s=e.addRemoteTextTrack(i({},a,{default:!1}),!0);return s.track.mode="hidden",o.push(s),-1===n&&!0===a.default?n=r:a.default=!1,a}));-1!==n&&(this.flag=r[n].label,this.track=o[n].track,this.track.mode="showing"),e.trigger("subtitles",r)}return this},n.remove=function(){var t=this;return this.values().forEach((function(e){t.player.removeRemoteTextTrack(e)})),this},n.pick=function(t){var e=this.values()[t];return e?(this.track&&(this.track.mode="disabled"),this.track=e,this.track.mode="showing"):this.track&&(this.track.mode="disabled"),this},e}(n.default.getPlugin("plugin"));n.default.hook("setup",(function(t){t.ready((function(){var e=t.options_.subtitles;e&&e.length&&t.subtitles().load(e)}))})),n.default.registerPlugin("subtitles",s)}));
